<div class="dashboard-container">

  <header class="section-header">
    <div class="title-wrapper">
      <h2>Resumen del Día</h2>
      <p class="subtitle">Gestiona tu imperio financiero.</p>
    </div>
    <span class="date-badge">{{ uiState.currentDate | date:'longDate' }}</span>
  </header>

  <div *ngIf="isLoading()" class="loading-state">
    <div class="spinner"></div>
    <p>Consultando libros contables...</p>
  </div>

  <div *ngIf="status()" class="stats-grid">

    <div class="card hero-card">
      <div class="card-header">
        <span class="label">DISPONIBLE PARA HOY</span>
        <div class="icon-circle">
          <span class="material-symbols-rounded">account_balance_wallet</span>
        </div>
      </div>

      <div class="amount-wrapper" [class.privacy-blur]="uiState.isPrivacyMode()">
        <h1 [style.color]="getAvailabilityColor(status()!.availableForToday)">
          {{ status()!.availableForToday | currency:'PEN':'symbol':'1.2-2' }}
        </h1>
      </div>

      <div class="card-footer">
        <span class="info-text">
          Quedan <strong>{{ status()!.remainingDays }} días</strong> en el mes
        </span>
      </div>

      <button class="btn-ritual" (click)="openRitual()">
        <span class="material-symbols-rounded">gavel</span>
        Cerrar Caja
      </button>
    </div>

    <div class="card metric-card">
      <div class="icon-box blue">
        <span class="material-symbols-rounded">flag</span>
      </div>
      <div class="metric-content">
        <span class="label">Límite Mensual</span>
        <span class="value" [class.privacy-blur]="uiState.isPrivacyMode()">
          {{ status()!.totalMonthLimit | currency:'PEN':'symbol':'1.0-0' }}
        </span>
      </div>
    </div>

    <div class="card metric-card">
      <div class="icon-box red">
        <span class="material-symbols-rounded">trending_down</span>
      </div>
      <div class="metric-content">
        <span class="label">Gastado Mes</span>
        <span class="value" [class.privacy-blur]="uiState.isPrivacyMode()">
          {{ status()!.totalMonthSpent | currency:'PEN':'symbol':'1.0-0' }}
        </span>
      </div>
    </div>

  </div>
</div>

<app-daily-ritual
  *ngIf="showRitual() && status()"
  [status]="status()!"
  (close)="showRitual.set(false)"
  (completed)="onRitualCompleted()">
</app-daily-ritual>
